import{_ as e}from"./Breadcrumbs.7ab39bf2.js";import{o as t,a as s,d as n,f as o,v as i,t as a,g as r,O as l,h as c,P as u,M as h,N as d,V as g,r as m,e as p,w as f}from"./vendor.dc6bd94e.js";const v={name:"formAdd",data:()=>({nameC:null,loading:!1,verif:!0,errorMessage:null,ok:!1}),methods:{addCategory(){const e=/^[^<>{}]*$/;let t={name:this.nameC};this.nameC?this.nameC.match(e)?fetch("https://warm-inlet-55236.herokuapp.com/api/categories",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":localStorage.getItem("token")},body:JSON.stringify(t)}).then((e=>e.json())).then((async e=>{e.status&&400===e.status?(this.toast(e.message,"warning"),this.verif=!1,this.errorMessage=e.message):e.status&&200===e.status?(this.$store.commit("incrementAllLinks",e.cat),this.toast("Category créée","success"),this.verif=!0,this.errorMessage=null,this.ok=!0,setTimeout((()=>{this.ok=!1}),3e3)):e.status&&401===e.status?this.logout():(this.toast("Une erreur est survenue.","error"),this.verif=!1,this.errorMessage=e.message),setTimeout((()=>{this.verif=!0}),3e3),this.nameC=null})).catch((e=>{this.toast("Une erreur est survenue.","danger"),this.verif=!1,this.errorMessage="Une erreur est survenue.",setTimeout((()=>{this.verif=!0}),3e3)})):(this.toast("Le nom ne doit pas contenir de caractères spéciaux.","warning"),this.verif=!1,this.errorMessage="Le nom ne doit pas contenir de caractères spéciaux.",setTimeout((()=>{this.verif=!0}),3e3)):(this.toast("Le nom est vide","warning"),this.verif=!1,this.errorMessage="Le nom est vide",setTimeout((()=>{this.verif=!0}),3e3))},toggleCatForm(){this.$refs.addCat.classList.toggle("active"),this.$refs.btnAddCat.classList.toggle("active")},logout(){localStorage.removeItem("token"),this.$router.push("/login"),this.$store.commit("clearAllLinks")}},setup:()=>({toast:(e,t)=>{c(e,{position:"top-right",timeout:3e3,type:t,showIcon:!0})}})},k=n("label",{for:"getName"},"Entrez le nom pour la nouvelle catégorie",-1),b={key:0,class:"text-red-500"},y={key:1,class:"text-green-400"},L=n("button",{class:"\n                    border border-success\n                    text-success\n                    hover:bg-success hover:text-white\n                    rounded\n                    px-2\n                "}," Créer ",-1);v.render=function(e,c,u,h,d,g){return t(),s("form",{ref:"addCat",id:"categoryForm",onSubmit:c[1]||(c[1]=l(((...e)=>g.addCategory&&g.addCategory(...e)),["prevent"])),method:"POST"},[n("div",null,[n("div",null,[k,o(n("input",{type:"text",id:"getName",placeholder:"Nom ici","onUpdate:modelValue":c[0]||(c[0]=e=>d.nameC=e),class:"\n                        w-full\n                        bg-gray-50\n                        h-10\n                        px-3\n                        mb-2\n                        text-base text-gray-700\n                        placeholder-gray-600\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                    "},null,512),[[i,d.nameC]])]),d.verif?r("",!0):(t(),s("p",b,a(d.errorMessage),1)),d.ok?(t(),s("p",y,"La catégorie a bien été crée.")):r("",!0),L])],544)};const w={name:"formAdd",props:["categories"],data(){return{link:null,method:"GET",category:this.categories[0].id,loading:!1,verif:!0,errorMessage:null,ok:!1}},methods:{addLink(){const e=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/gm;let t={link:this.link,method:this.method,statusCode:200,health:!0,category:this.category};this.link?this.link.match(e)?fetch("https://warm-inlet-55236.herokuapp.com/api/links",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":localStorage.getItem("token")},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{e.status&&400===e.status?(this.toast(e.message,"warning"),this.verif=!1,this.errorMessage=e.message):e.status&&200===e.status?(this.toast("Lien ajouté","success"),this.$emit("addLink"),this.verif=!0,this.ok=!0,setTimeout((()=>{this.ok=!1}),3e3)):e.status&&401===e.status?this.logout():(this.toast("Une erreur est survenue.","danger"),this.verif=!1,this.errorMessage=e.message?e.message:"Une erreur est survenue."),setTimeout((()=>{this.verif=!0}),3e3),this.link=null})).catch((e=>{this.toast("Une erreur est survenue.","danger"),this.verif=!1,this.errorMessage="Une erreur est survenue.",setTimeout((()=>{this.verif=!0}),3e3)})):(this.toast("Ce n'est pas un lien valide.","warning"),this.verif=!1,this.link=null,this.errorMessage="Ce n'est pas un lien valide.",setTimeout((()=>{this.verif=!0}),3e3)):(this.toast("Veuillez entrer un lien","warning"),this.verif=!1,this.errorMessage="Veuillez entrer un lien",setTimeout((()=>{this.verif=!0}),3e3))},toggleLinkForm(){this.$refs.addLink.classList.toggle("active"),this.$refs.btnAddLink.classList.toggle("active")},logout(){localStorage.removeItem("token"),this.$router.push("/login"),this.$store.commit("clearAllLinks")}},setup:()=>({toast:(e,t)=>{c(e,{position:"top-right",timeout:5e3,type:t,showIcon:!0})}})},x=n("label",{for:"getLink"},"Entrez le lien et la méthode que vous voulez ajouter.",-1),T={class:"flex flex-col"},C=n("label",{for:"methid"},"Méthode:",-1),M=[n("option",{value:"GET"},"GET",-1),n("option",{value:"POST"},"POST",-1),n("option",{value:"DELETE"},"DELETE",-1),n("option",{value:"PUT"},"PUT",-1)],U=n("label",{for:"category"},"Catégorie:",-1),E=["value"],$={key:0,class:"text-red-500"},S={key:1,class:"text-green-400"},D=n("button",{class:"\n                    border border-success\n                    text-success\n                    bg-gray-50\n                    hover:bg-success hover:text-white\n                    rounded\n                    px-2\n                "}," Ajouter ",-1);w.render=function(e,c,g,m,p,f){return t(),s("form",{id:"linkForm",onSubmit:c[3]||(c[3]=l(((...e)=>f.addLink&&f.addLink(...e)),["prevent"])),method:"POST",ref:"addLink",class:"flex flex-col"},[n("div",null,[n("div",null,[x,o(n("input",{type:"text",id:"getLink",placeholder:"Lien ici","onUpdate:modelValue":c[0]||(c[0]=e=>p.link=e),class:"\n                        w-full\n                        h-10\n                        px-3\n                        mb-2\n                        text-base text-gray-700\n                        placeholder-gray-600\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                    "},null,512),[[i,p.link]])]),n("div",T,[C,o(n("select",{name:"method","onUpdate:modelValue":c[1]||(c[1]=e=>p.method=e),class:"\n                        w-auto\n                        h-10\n                        pl-3\n                        pr-6\n                        bg-gray-50\n                        text-base\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                        mb-4\n                    "},M,512),[[u,p.method]]),U,o(n("select",{name:"category","onUpdate:modelValue":c[2]||(c[2]=e=>p.category=e),class:"\n                        w-auto\n                        h-10\n                        pl-3\n                        pr-6\n                        text-base\n                        bg-gray-50\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                        mb-4\n                    "},[(t(!0),s(h,null,d(this.categories,(e=>(t(),s("option",{key:e,value:e.id},a(e.name),9,E)))),128))],512),[[u,p.category]])]),p.verif?r("",!0):(t(),s("p",$,a(p.errorMessage),1)),p.ok?(t(),s("p",S,"Le lien/la requête a bien été ajouté(e).")):r("",!0),D])],544)};const P={name:"formAdd",props:["categories"],data(){return{category:this.categories[0].id,action:"PUT",newName:this.categories[0].name,userData:g.decode(localStorage.getItem("token")),verif:!0,errorMessage:null,ok:!1,okMessage:null}},methods:{modDelCategory(){const e=/^[^<>{}]*$/;let t={name:this.newName};this.newName&&""!==this.newName?this.newName!==this.categories.find((e=>e.id===this.category)).name||"DELETE"===this.action?this.newName.match(e)?fetch(`https://warm-inlet-55236.herokuapp.com/api/user/${this.userData.userId}/categories/${this.category}`,{method:this.action,headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":localStorage.getItem("token")},body:JSON.stringify(t)}).then((e=>e.json())).then((async e=>{"DELETE"===this.action?200===e.status?(this.$store.commit("deleteAllLinks",this.category),this.toast(e.message,"success"),this.category=this.categories[0].id,this.verif=!0,this.ok=!0,this.okMessage=e.message?e.message:"Catégorie supprimé.",setTimeout((()=>{this.ok=!1}),3e3)):401===e.status?this.logout():(this.toast(e.message,"danger"),this.verif=!1,this.errorMessage=e.message?e.message:"Une erreur est survenue."):"PUT"===this.action&&(200===e.status?(this.$store.commit("modifyAllLinks",{cat:this.category,name:this.newName}),this.toast(e.message,"success"),this.verif=!0,this.ok=!0,this.okMessage=e.message?e.message:"Catégorie modifié.",setTimeout((()=>{this.ok=!1}),3e3)):401===e.status?this.logout():(this.toast(e.message,"danger"),this.verif=!1,this.errorMessage=e.message?e.message:"Une erreur est survenue.")),setTimeout((()=>{this.verif=!0}),3e3)})).catch((e=>{console.log(e),this.toast("Une erreur est survenue.","danger"),this.verif=!1,this.errorMessage="Une erreur est survenue.",setTimeout((()=>{this.verif=!0}),3e3)})):(this.toast("Le nom de la catégorie ne doit pas contenir de caractères spéciaux.","danger"),this.verif=!1,this.errorMessage="Le nom de la catégorie ne doit pas contenir de caractères spéciaux.",setTimeout((()=>{this.verif=!0}),3e3)):(this.toast("Les deux nom sont identiques !","danger"),this.verif=!1,this.errorMessage="Les deux nom sont identiques !",setTimeout((()=>{this.verif=!0}),3e3)):(this.toast("Le nom ne peut être vide.","danger"),this.verif=!1,this.errorMessage="Le nom ne peut être vide.",setTimeout((()=>{this.verif=!0}),3e3))},toggleCatDelForm(){this.$refs.delCat.classList.toggle("active"),this.$refs.btnDelCat.classList.toggle("active")},logout(){localStorage.removeItem("token"),this.$router.push("/login"),this.$$store.commit("clearAllLinks")}},setup:()=>({toast:(e,t)=>{c(e,{position:"top-right",timeout:5e3,type:t,showIcon:!0})}}),mounted(){}},A=n("label",{for:"getName"},"Choisissez une catégorie et l'action à effectuer.",-1),j={class:"flex flex-col"},N=n("label",{for:"category"},"Catégorie:",-1),I=["value"],O=n("label",{for:"delormod"},"Action:",-1),V=[n("option",{value:"PUT"},"Modifier",-1),n("option",{value:"DELETE"},"Supprimer",-1)],F={key:0},_={key:0,class:"text-red-500"},z={key:1,class:"text-green-400"},q=n("button",{class:"\n                    border border-success\n                    text-success\n                    hover:bg-success hover:text-white\n                    rounded\n                    px-2\n                "}," Valider ",-1);P.render=function(e,c,g,m,p,f){return t(),s("form",{id:"catDeleteForm",onSubmit:c[4]||(c[4]=l(((...e)=>f.modDelCategory&&f.modDelCategory(...e)),["prevent"])),method:"POST",ref:"delCat"},[n("section",null,[n("div",null,[A,n("div",j,[N,o(n("select",{name:"category","onUpdate:modelValue":c[0]||(c[0]=e=>p.category=e),onChange:c[1]||(c[1]=e=>p.newName=this.categories.find((e=>e.id===p.category)).name),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            bg-gray-50\n                            pr-6\n                            text-base\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},[(t(!0),s(h,null,d(this.categories,(e=>(t(),s("option",{key:e,value:e.id},a(e.name),9,I)))),128))],544),[[u,p.category]]),O,o(n("select",{name:"delormod","onUpdate:modelValue":c[2]||(c[2]=e=>p.action=e),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            pr-6\n                            bg-gray-50\n                            text-base\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},V,512),[[u,p.action]])]),"PUT"===p.action?(t(),s("label",F,"Changez le nom ici:")):r("",!0),"PUT"===p.action?o((t(),s("input",{key:1,type:"text","onUpdate:modelValue":c[3]||(c[3]=e=>p.newName=e),class:"\n                        w-full\n                        h-10\n                        px-3\n                        mb-2\n                        text-base text-gray-700\n                        bg-gray-50\n                        placeholder-gray-600\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                        mb-4\n                    "},null,512)),[[i,p.newName]]):r("",!0)]),p.verif?r("",!0):(t(),s("p",_,a(p.errorMessage),1)),p.ok?(t(),s("p",z,a(p.okMessage),1)):r("",!0),q])],544)};const G={name:"formAdd",props:["categories"],data(){return{category:this.categories[0].id,action:"PUT",newLink:"",allLinks:[],selectedLink:null,method:null,newCat:null,userData:g.decode(localStorage.getItem("token")),verif:!0,errorMessage:null,ok:!1,okMessage:null}},methods:{selectLink(){fetch(`https://warm-inlet-55236.herokuapp.com/api/user/${this.userData.userId}/categories/${this.category}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":localStorage.getItem("token")}}).then((e=>e.json())).then((async e=>{this.allLinks=e.cat.sites,this.newLink=e.cat.sites[0]?e.cat.sites[0].link:"Cette catégorie est vide",this.selectedLink=e.cat.sites[0]?e.cat.sites[0]._id:"Cette catégorie est vide",this.method=e.cat.sites[0]?e.cat.sites[0].method:"GET",this.newCat=this.category})).catch((e=>{console.log(e),this.toast("Une erreur est survenue.","danger")}))},toggleDelLinkForm(){this.$refs.delLink.classList.toggle("active"),this.$refs.btnDelLink.classList.toggle("active")},changeData(){let e=this.allLinks.find((e=>e._id===this.selectedLink));this.method=e.method,this.newLink=e.link},delModLink(){let e=this.allLinks.find((e=>e._id===this.selectedLink)),t={category:this.category,link:this.newLink||null,action:this.action,method:this.method||null,newCategory:this.newCat||null};if(this.method!==e.method||this.newLink!==e.link||this.category!==this.newCat&&"PUT"===this.action||"DELETE"===this.action){const e=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/gm;this.newLink.match(e)&&"PUT"===this.action||"DELETE"===this.action?fetch(`https://warm-inlet-55236.herokuapp.com/api/user/${this.userData.userId}/links/${this.selectedLink}`,{method:this.action,headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":localStorage.getItem("token")},body:JSON.stringify(t)}).then((e=>e.json())).then((async e=>{200===e.status?(this.toast(e.message,"success"),this.selectLink(),this.verif=!0,this.ok=!0,"DELETE"===this.action?this.okMessage="Le lien a bien été supprimé":this.okMessage="Le lien a bien été modifié",setTimeout((()=>{this.ok=!1}),3e3)):400===e.status?(this.toast(e.message,"warning"),this.verif=!1,this.errorMessage=e.message?e.message:"Une erreur est survenue."):401===e.status?this.logout():(this.toast("Une erreur est survenue.","danger"),this.verif=!1,this.errorMessage=e.message?e.message:"Une erreur est survenue."),setTimeout((()=>{this.verif=!0}),3e3),this.changeData()})).catch((e=>{console.log(e),this.toast("Une erreur est survenue.","danger"),this.verif=!1,setTimeout((()=>{this.verif=!0}),3e3),this.errorMessage="Une erreur est survenue."})):(this.toast("Le lien n'est pas valide.","warning"),this.verif=!1,this.errorMessage="Le lien n'est pas valide.",setTimeout((()=>{this.verif=!0}),3e3))}else this.toast("Tous les paramètres sont identiques !","warning"),this.verif=!1,this.errorMessage="Tous les paramètres sont identiques !",setTimeout((()=>{this.verif=!0}),3e3)},use(){this.delModLink(),this.selectLink(),this.changeData()},logout(){localStorage.removeItem("token"),this.$router.push("/login"),this.$store.commit("clearAllLinks")}},setup:()=>({toast:(e,t)=>{c(e,{position:"top-right",timeout:3e3,type:t,showIcon:!0})}}),mounted(){this.selectLink()}},J={class:"flex flex-col"},B=n("label",{for:"getName"},"Choisir une catégorie, séléctionner un lien, choix de l'actions, modifications des paramètres voulus.",-1),H={class:"flex flex-col"},K=n("label",{for:"category"},"Catégorie:",-1),Q=["value"],R=n("label",{for:"delormod"},"Action:",-1),W=[n("option",{value:"PUT"},"Modifier",-1),n("option",{value:"DELETE"},"Supprimer",-1)],X=n("label",{for:"allLink"},"Selectionnez le lien:",-1),Y=["value"],Z={key:0,class:"flex flex-col"},ee=n("label",{for:"method"},"Nouvelle méthode:",-1),te=[n("option",{value:"GET"},"GET",-1),n("option",{value:"POST"},"POST",-1),n("option",{value:"DELETE"},"DELETE",-1),n("option",{value:"PUT"},"PUT",-1)],se=n("label",{for:"newCat"},"Nouvelle catégorie",-1),ne=["value"],oe={key:1},ie={key:0,class:"text-red-500"},ae={key:1,class:"text-green-400"},re=n("button",{class:"\n                    border border-success\n                    text-success\n                    hover:bg-success hover:text-white\n                    rounded\n                    px-2\n                "}," Valider ",-1);G.render=function(e,c,g,m,p,f){return t(),s("form",{id:"deleteLinkForm",method:"POST",onSubmit:c[8]||(c[8]=l(((...e)=>f.use&&f.use(...e)),["prevent"])),ref:"delLink"},[n("section",null,[n("div",J,[B,n("div",H,[K,o(n("select",{name:"category","onUpdate:modelValue":c[0]||(c[0]=e=>p.category=e),onChange:c[1]||(c[1]=(...e)=>f.selectLink&&f.selectLink(...e)),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            pr-6\n                            text-base\n                            bg-gray-50\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},[(t(!0),s(h,null,d(this.categories,(e=>(t(),s("option",{key:e,value:e.id},a(e.name),9,Q)))),128))],544),[[u,p.category]]),R,o(n("select",{name:"delormod","onUpdate:modelValue":c[2]||(c[2]=e=>p.action=e),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            pr-6\n                            text-base\n                            bg-gray-50\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},W,512),[[u,p.action]])]),X,o(n("select",{name:"allLink","onUpdate:modelValue":c[3]||(c[3]=e=>p.selectedLink=e),onChange:c[4]||(c[4]=(...e)=>f.changeData&&f.changeData(...e)),class:"\n                        w-auto\n                        h-10\n                        pl-3\n                        pr-6\n                        text-base\n                        bg-gray-50\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                        mb-4\n                    "},[(t(!0),s(h,null,d(p.allLinks,(e=>(t(),s("option",{key:e.link,value:e._id},a(e.link+" ("+e.method+")"),9,Y)))),128))],544),[[u,p.selectedLink]]),"PUT"===p.action?(t(),s("div",Z,[ee,o(n("select",{name:"method","onUpdate:modelValue":c[5]||(c[5]=e=>p.method=e),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            pr-6\n                            text-base\n                            bg-gray-50\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},te,512),[[u,p.method]]),se,o(n("select",{name:"newCat","onUpdate:modelValue":c[6]||(c[6]=e=>p.newCat=e),class:"\n                            w-auto\n                            h-10\n                            pl-3\n                            pr-6\n                            text-base\n                            bg-gray-50\n                            border\n                            rounded-lg\n                            focus:shadow-outline\n                            mb-4\n                        "},[(t(!0),s(h,null,d(this.categories,(e=>(t(),s("option",{key:e,value:e.id},a(e.name),9,ne)))),128))],512),[[u,p.newCat]])])):r("",!0),"PUT"===p.action?(t(),s("label",oe,"Changez le lien ici:")):r("",!0),"PUT"===p.action?o((t(),s("input",{key:2,type:"text","onUpdate:modelValue":c[7]||(c[7]=e=>p.newLink=e),class:"\n                        w-full\n                        h-10\n                        px-3\n                        mb-2\n                        bg-gray-50\n                        text-base text-gray-700\n                        placeholder-gray-600\n                        border\n                        rounded-lg\n                        focus:shadow-outline\n                        mb-4\n                    "},null,512)),[[i,p.newLink]]):r("",!0)]),p.verif?r("",!0):(t(),s("p",ie,a(p.errorMessage),1)),p.ok?(t(),s("p",ae,a(p.okMessage),1)):r("",!0),re])],544)};const le={class:"container mx-auto"},ce={class:"mt-10"},ue={class:"grid md:grid-cols-1 sm:grid-cols-1 gap-4"},he=n("div",{class:"card-title mb-5 text-green-500"},"Créer une Catégorie",-1),de={key:0},ge=n("div",{class:"card-title mb-5 text-green-500"},"Ajouter un lien/une requête",-1),me={key:1},pe=n("div",{class:"card-title mb-5 text-green-500"},"Modifier ou supprimer une Catégorie",-1),fe={key:2},ve=n("div",{class:"card-title mb-5 text-green-500"},"Modifier ou supprimer un lien/une requête",-1);const ke={name:"Options",components:{Form1:v,Form2:w,Form3:P,Form4:G},computed:{storeCat(){return this.$store.state.allLinks}},methods:{updateLinks(){this.$refs.formDel.selectLink()}}},be=Object.assign(ke,{setup:function(o){return(o,i)=>{const a=m("BaseCard");return t(),s("div",le,[p(e,{parentTitle:"Options"}),n("div",ce,[n("div",ue,[n("div",null,[p(a,null,{default:f((()=>[he,p(v)])),_:1})]),0!==o.storeCat.length?(t(),s("div",de,[p(a,null,{default:f((()=>[ge,p(w,{categories:o.storeCat,onAddLink:o.updateLinks},null,8,["categories","onAddLink"])])),_:1})])):r("",!0),0!==o.storeCat.length?(t(),s("div",me,[p(a,null,{default:f((()=>[pe,p(P,{categories:o.storeCat},null,8,["categories"])])),_:1})])):r("",!0),0!==o.storeCat.length?(t(),s("div",fe,[p(a,null,{default:f((()=>[ve,p(G,{categories:o.storeCat},null,8,["categories"])])),_:1})])):r("",!0)])])])}}});export{be as default};
